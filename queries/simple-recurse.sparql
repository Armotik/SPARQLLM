# Simple recursive query example
# Run with:
# slm-run --config config.ini -f queries/simple-recurse.sparql --debug

PREFIX ex: <http://example.org/>
PREFIX ggf: <http://example.org/>

SELECT ?s ?p ?o  WHERE {
  BIND(ggf:SLM-GRAPH("""
    PREFIX ex: <http://example.org/>
    ex:a ex:linkedTo ex:b .
    ex:b ex:linkedTo ex:c .
    ex:c ex:linkedTo ex:d .
    ex:d ex:linkedTo ex:a .
  """) AS ?ginit)

  BIND("""
    PREFIX ex: <http://example.org/>
    CONSTRUCT {
      ?x ?p ?z .
    } WHERE {
      {
        ?x ?p ?y .
        ?y ?p ?z .
      } UNION { 
        ?x ?p ?z .
      }
    }
  """ AS ?query_str)

  BIND(ggf:SLM-RECURSE(?query_str, ?ginit, 10) AS ?out)

  GRAPH ?out {
    ?s ?p ?o .
  }
}
