# slm-run --config config.ini -f queries/simple-groq.sparql --debug

PREFIX wdt: <http://www.wikidata.org/prop/direct/>    # Propriétés directes (ex. wdt:P31 pour "instance de")
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX wd: <http://www.wikidata.org/entity/>  
PREFIX ex: <http://example.org/>
PREFIX schema: <http://schema.org/>

select * {
    # strange only 85 raise an error...
    BIND(ex:SLM-FILE("./data/events/event_85.txt") AS ?uri)
    BIND(ex:SLM-READFILE(?uri) AS ?page)

    BIND(CONCAT("""
    Extract from the text below the date and the name of the event.

    Return **only** a JSON-LD object of type `Event` using the `http://schema.org/` context, in the following format:

    {
      "@context": "http://schema.org/",
      "@type": "Event",
      "startDate": "2025-01-01",
      "name": "Sample Event Name"
    }

    - Replace the example values with the actual event date and event name.
    - The output must be valid JSON-LD with no explanations, comments, or Markdown formatting.
    - Output **only** the JSON object.

    Here is the text to analyze:
    <text>""",STR(?page),"</text>") AS ?prompt)
    BIND(ex:SLM-LLMGRAPH_GROQM(?prompt,?uri,"llama3-8b-8192") AS ?g8)
    BIND(ex:SLM-LLMGRAPH_GROQM(?prompt,?uri,"llama3-70b-8192") AS ?g70)
    BIND(ex:SLM-LLMGRAPH_GROQM(?prompt,?uri,"qwen-TAGADA-32b") AS ?g32)
    {
     GRAPH ?g8 {
        ?uri ex:has_schema_type ?root . 
        ?root a schema:Event. 
        ?root schema:startDate ?date.
        ?root schema:name ?name
     }
    }  UNION {
      GRAPH ?g70 {
        ?uri ex:has_schema_type ?root . 
        ?root a schema:Event. 
        ?root schema:startDate ?date.
        ?root schema:name ?name
      }
    } UNION {
      GRAPH ?g32 {
        ?uri ex:has_schema_type ?root . 
        ?root a schema:Event. 
        ?root schema:startDate ?date.
        ?root schema:name ?name
      }
    }   
}